version: 2.1

setup: true

orbs:
  path-filtering: circleci/path-filtering@0.1.1

parameters:
  project-from-client:
    type: string
    default: nothing

workflows:
  filter-based-on-changes-workflow:
    jobs:
      - path-filtering/filter:
          name: check-files
          base-revision: develop
          config-path: .circleci/main-config.yml
          mapping: |
            pepper-apis/docs/.* project "api-docs"

  ondemand-api-docs:
    when:
      equal: ["api-docs", << pipeline.parameters.project-from-client >>]
    jobs:
      - continuation/continue:
          configuration_path: .circleci/config.yml
          parameters: '{"project": "api-docs"}'
